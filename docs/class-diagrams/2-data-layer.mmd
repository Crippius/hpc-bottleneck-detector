classDiagram
    %% ============================================
    %% DATA LAYER VIEW
    %% Focus: Data Sources → Windowing → Features
    %% ============================================
    
    class IDataSource {
        <<interface>>
        +fetch_job_data(job_id: str) DataManager
    }

    class CSVDataSource {
        -file_path: str
        -delimiter: str
        +__init__(file_path: str, delimiter: str)
        +fetch_job_data(job_id: str) DataManager
    }

    class RestAPIDataSource {
        -api_endpoint: str
        -auth_token: str
        +__init__(api_endpoint: str, auth_token: str)
        +fetch_job_data(job_id: str) DataManager
    }

    class DatabaseDataSource {
        -connection_string: str
        +__init__(connection_string: str)
        +fetch_job_data(job_id: str) DataManager
    }

    class WindowProvider {
        -full_job_data: DataFrame
        -window_size: int
        -step_size: int
        +__init__(full_job_data: DataFrame, window_size: int, step_size: int)
        +generate_windows() Generator~DataFrame~
        +get_window_at(index: int) DataFrame
        +get_total_windows() int
    }

    class JobContext {
        -job_metadata: dict
        -job_id: str
        -config: dict
        +__init__(job_id: str, job_metadata: dict, config: dict)
        +get_metadata(key: str) any
        +get_job_id() str
    }

    class FeatureService {
        -feature_extractor: FeatureExtractor
        +__init__(feature_extractor: FeatureExtractor)
        +extract_features(window: DataFrame, metrics: list~str~) FeatureVector
        +get_feature_vector(window: DataFrame) FeatureVector
    }

    class FeatureExtractor {
        +__init__()
        +calculate_statistics(df: DataFrame) FeatureVector
        +extract_features(metrics: list~str~, window: DataFrame) FeatureVector
        -compute_mean(values: Series) float
        -compute_std_dev(values: Series) float
        -compute_skewness(values: Series) float
        -compute_kurtosis(values: Series) float
    }

    class FeatureVector {
        -features: dict~str, float~
        -timestamp: datetime
        +__init__(features: dict, timestamp: datetime)
        +get_feature(name: str) float
        +to_array() ndarray
    }

    class DataManager {
        -current_window: DataFrame
        +__init__(window_provider: WindowProvider, feature_service: FeatureService, job_context: JobContext)
        +get_metric(metric_id: str) float
        +get_metrics(metric_ids: list~str~) dict
        +get_feature_vector(metrics: list~str~) FeatureVector
        +iterate_windows() Generator~DataManager~
    }

    %% Relationships
    IDataSource <|.. CSVDataSource
    IDataSource <|.. RestAPIDataSource
    IDataSource <|.. DatabaseDataSource
    IDataSource --> DataManager : creates

    DataManager o-- WindowProvider : uses
    DataManager o-- FeatureService : uses
    DataManager o-- JobContext : uses

    FeatureService *-- FeatureExtractor : uses
    FeatureExtractor --> FeatureVector : produces
